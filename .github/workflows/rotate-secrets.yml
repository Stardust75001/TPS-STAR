name: Rotate Secrets Quarterly

on:
  schedule:
    # Runs at 4am on the first day of January, April, July, October (quarterly)
    - cron: '0 4 1 1,4,7,10 *'

jobs:
  rotate-secrets:
    runs-on: ubuntu-latest
    steps:
      - name: Generate new secrets (custom script or API call)
        run: |
          # Example: Replace with your actual secret generation logic
          echo "NEW_SHOPIFY_API_KEY=your_new_key_value" >> $GITHUB_ENV

      - name: Update GitHub secret
        run: |
          gh secret set SHOPIFY_API_KEY -b"$NEW_SHOPIFY_API_KEY"
        env:
          GH_TOKEN: ${{ secrets.GH_FINEGRAINED_TOKEN }}

      # Repeat for other secrets as needed
      # - name: Update SENTRY_DSN
      #   run: gh secret set SENTRY_DSN -b"$NEW_SENTRY_DSN"
      #   env:
      #     GH_TOKEN: ${{ secrets.GH_FINEGRAINED_TOKEN }}
